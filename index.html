<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BooterSpace</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
    import { 
      getFirestore, 
      collection, 
      query, 
      where, 
      orderBy, 
      limit, 
      getDocs 
    } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";
    import { 
      getAuth, 
      signInAnonymously
    } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
      authDomain: "kar-kardan.firebaseapp.com",
      projectId: "kar-kardan",
      storageBucket: "kar-kardan.firebasestorage.app",
      messagingSenderId: "554147696994",
      appId: "1:554147696994:web:221dcb883e3b65dcea5c3b",
      measurementId: "G-RRC3X485KQ"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    const initAuth = async () => {
      try {
        await signInAnonymously(auth);
      } catch (e) {
        console.warn("Auth disabled or failed", e);
      }
    };

    window.addEventListener("DOMContentLoaded", async () => {
      const featuredContainer = document.getElementById("featured-jobs");
      const govtContainer = document.getElementById("govt-jobs");
      const latestContainer = document.getElementById("latest-updates");

      await initAuth();

      // --- FEATURED JOBS (LIMIT 3) ---
      try {
        const featuredQuery = query(
          collection(db, "jobs"),
          where("status", "==", "approved"),
          orderBy("timestamp", "desc"),
          limit(3)
        );

        const featuredSnapshot = await getDocs(featuredQuery);
        if (featuredSnapshot.empty) {
          featuredContainer.innerHTML = `<div class="p-4 text-center text-gray-400 text-xs">No jobs found</div>`;
        } else {
          featuredContainer.innerHTML = '';
          featuredSnapshot.forEach(doc => {
            const job = doc.data();
            const jobId = doc.id;
            const logo = job.companyImageUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(job.company || 'C')}&background=random`;

            featuredContainer.innerHTML += `
              <a href="job-detail.html?id=${jobId}" class="group block p-4 hover:bg-blue-50/50 transition-all border-b border-gray-50 last:border-0 relative">
                <div class="flex items-center gap-3">
                    <img src="${logo}" class="w-10 h-10 rounded-lg object-cover border border-gray-100 bg-white flex-shrink-0">
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-2">
                            <h3 class="text-sm font-bold text-gray-900 truncate">${job.title}</h3>
                            <span class="blink-new text-[9px] font-black text-blue-600 bg-blue-100 px-1 rounded">NEW</span>
                        </div>
                        <p class="text-xs text-gray-500 truncate">${job.company}</p>
                    </div>
                    <svg class="w-4 h-4 text-gray-300 group-hover:text-blue-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
              </a>`;
          });
        }
      } catch (err) { console.error(err); }

      // --- GOVT JOBS (LIMIT 3) ---
      try {
        const govtQuery = query(collection(db, "govtJobs"), orderBy("timestamp", "desc"), limit(3));
        const govtSnapshot = await getDocs(govtQuery);
        if (govtSnapshot.empty) {
          govtContainer.innerHTML = `<div class="p-4 text-center text-gray-400 text-xs">No notifications</div>`;
        } else {
          govtContainer.innerHTML = '';
          govtSnapshot.forEach(doc => {
            const job = doc.data();
            const jobId = doc.id;
            const logo = job.companyImageUrl || "https://img.icons8.com/color/96/government-buildings.png";

            govtContainer.innerHTML += `
              <a href="job-detail.html?id=${jobId}" class="group block p-4 hover:bg-orange-50/50 transition-all border-b border-gray-50 last:border-0 relative">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-lg bg-orange-50 flex items-center justify-center flex-shrink-0">
                        <img src="${logo}" class="w-6 h-6 object-contain">
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-2">
                            <h3 class="text-sm font-bold text-gray-900 truncate">${job.title}</h3>
                            <span class="blink-new text-[9px] font-black text-orange-600 bg-orange-100 px-1 rounded">NEW</span>
                        </div>
                        <p class="text-xs text-orange-600 font-medium truncate">${job.companyName || "Govt Sector"}</p>
                    </div>
                    <svg class="w-4 h-4 text-gray-300 group-hover:text-orange-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
              </a>`;
          });
        }
      } catch (e) { console.error(e); }

      // --- LATEST UPDATES (LIMIT 3) ---
      try {
        const latestQuery = query(collection(db, "flashLinks"), orderBy("timestamp", "desc"), limit(3));
        const latestSnapshot = await getDocs(latestQuery);
        latestContainer.innerHTML = '';
        latestSnapshot.forEach(doc => {
          const item = doc.data();
          latestContainer.innerHTML += `
            <a href="${item.url}" target="_blank" class="group block p-4 hover:bg-yellow-50/50 transition-all border-b border-gray-50 last:border-0">
              <div class="flex items-start gap-3">
                <span class="text-yellow-500 mt-0.5">âš¡</span>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1">
                        <span class="text-xs font-bold text-gray-800 group-hover:text-blue-700 leading-tight line-clamp-1">${item.title}</span>
                        <span class="blink-new text-[9px] font-black text-yellow-700 bg-yellow-100 px-1 rounded">NEW</span>
                    </div>
                    <p class="text-[10px] text-gray-400">Update received just now</p>
                </div>
              </div>
            </a>`;
        });
      } catch (e) { console.error(e); }
    });
  </script>

  <style>
    @keyframes blink {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.95); }
    }
    .blink-new {
      animation: blink 1s infinite ease-in-out;
    }
    body { background-color: #f8fafc; }
  </style>
</head>

<body class="font-sans antialiased text-gray-900 bg-gray-50">

  <!-- ðŸ”¥ SaaS Navbar -->
<div id="navbar"></div>

<script>
fetch("navbar.html")
.then(r=>r.text())
.then(html=>{
  document.getElementById("navbar").innerHTML=html;
  const s=document.createElement("script");
  s.src="navbar.js";
  document.body.appendChild(s);
});
</script>

  <header class="bg-white border-b border-gray-200 py-10">
    <div class="max-w-7xl mx-auto px-4 text-center">
        <h1 class="text-3xl font-black tracking-tight text-gray-900 sm:text-4xl">
            Booter<span class="text-blue-600">Space</span>
        </h1>
        <p class="mt-2 text-sm text-gray-500 max-w-md mx-auto">
            The most compact way to track your career opportunities.
        </p>
    </div>
  </header>

  <main class="max-w-7xl mx-auto py-8 px-4 sm:px-6">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      
      <!-- Panel 1 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
        <div class="px-5 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
            <div class="flex items-center gap-2">
                <span class="w-1.5 h-4 bg-blue-600 rounded-full"></span>
                <h2 class="font-bold text-gray-900 text-xs uppercase tracking-widest">Featured</h2>
            </div>
            <a href="jobs.html" class="text-[10px] font-black text-blue-600 hover:underline">BROWSE ALL</a>
        </div>
        <div id="featured-jobs" class="flex-grow">
            <!-- Dynamic Content -->
        </div>
      </div>

      <!-- Panel 2 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
        <div class="px-5 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
            <div class="flex items-center gap-2">
                <span class="w-1.5 h-4 bg-orange-500 rounded-full"></span>
                <h2 class="font-bold text-gray-900 text-xs uppercase tracking-widest">Govt. Jobs</h2>
            </div>
            <a href="#" class="text-[10px] font-black text-orange-600 hover:underline">BROWSE ALL</a>
        </div>
        <div id="govt-jobs" class="flex-grow">
            <!-- Dynamic Content -->
        </div>
      </div>

      <!-- Panel 3 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
        <div class="px-5 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
            <div class="flex items-center gap-2">
                <span class="w-1.5 h-4 bg-yellow-400 rounded-full"></span>
                <h2 class="font-bold text-gray-900 text-xs uppercase tracking-widest">Updates</h2>
            </div>
        </div>
        <div id="latest-updates" class="flex-grow">
            <!-- Dynamic Content -->
        </div>
      </div>

    </div>
  </main>

  <footer class="mt-12 py-8 text-center">
      <p class="text-gray-400 text-[10px] font-bold uppercase tracking-widest">Â© 2026 BooterSpace</p>
  </footer>

</body>
</html>
