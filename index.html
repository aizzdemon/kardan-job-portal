<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KARDAN - Job Listings</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    <style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #f9f9f9, #e3eaf2);
    margin: 0;
    padding: 0;
    color: #333;
  }

  .logo-box {
    position: absolute;
    top: 15px;
    left: 15px;
    background: rgba(255, 87, 51, 0.85);
    backdrop-filter: blur(10px);
    color: #fff;
    padding: 10px 20px;
    font-size: 20px;
    font-weight: bold;
    border-radius: 8px;
    text-decoration: none;
    box-shadow: 0 4px 10px rgba(255, 87, 51, 0.4);
    transition: background 0.3s ease;
  }

  .logo-box:hover {
    background: rgba(255, 87, 51, 1);
  }

  header {
    background-color: #ffffffcc;
    padding: 15px 0;
    position: sticky;
    top: 0;
    backdrop-filter: blur(12px);
    box-shadow: 0px 3px 8px rgba(0, 0, 0, 0.05);
    z-index: 1000;
  }

  nav .nav-container {
    display: flex;
    justify-content: space-between;
    max-width: 1200px;
    margin: 0 auto;
    align-items: center;
    flex-wrap: wrap;
  }

  nav ul {
    display: flex;
    gap: 10px;
    padding: 0;
    margin: 0;
    list-style: none;
  }

  .nav-button,
  .join-button {
    background: #357ABD;
    color: white;
    padding: 10px 16px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 600;
    border: none;
    cursor: pointer;
    text-decoration: none;
    transition: background 0.3s ease;
    display: flex;
    align-items: center;
  }

  .nav-button:hover,
  .join-button:hover {
    background: #285ea8;
  }

  .nav-button i,
  .join-button i {
    margin-right: 6px;
  }

  .button-section {
    position: sticky;
    top: 90px;
    background: #f9f9f9cc;
    backdrop-filter: blur(10px);
    padding: 15px;
    text-align: center;
    z-index: 900;
  }

  .action-button {
    font-weight: bold;
    font-size: 15px;
    padding: 12px 24px;
    margin: 5px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    text-decoration: none;
    transition: transform 0.2s ease, background-color 0.3s;
  }

  .action-button:hover {
    transform: translateY(-2px);
  }

  .find-button {
    background-color: #28a745;
    color: white;
  }

  .find-button:hover {
    background-color: #1e7e34;
  }

  .post-button {
    background-color: #007bff;
    color: white;
  }

  .post-button:hover {
    background-color: #0056b3;
  }

  .post-box {
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid #d1d9e6;
    border-radius: 12px;
    padding: 20px;
    margin: 40px auto 0;
    max-width: 600px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.08);
    transition: box-shadow 0.3s ease;
  }

  .post-box:hover {
    box-shadow: 0 10px 24px rgba(0,0,0,0.1);
  }

  textarea#postText {
    width: 100%;
    padding: 10px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 8px;
    resize: none;
    height: 50px;
    background-color: #fdfdfd;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.03);
  }

  input#postMedia {
    margin-top: 10px;
    display: block;
    background-color: #f0f6ff;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }

  button.post-btn {
    background-color: #007bff;
    color: white;
    padding: 10px 18px;
    margin-top: 12px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  button.post-btn:hover {
    background-color: #0056b3;
  }

  #postsContainer > div {
    background: #fff;
    border-radius: 10px;
    padding: 18px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    margin-bottom: 20px;
    transition: transform 0.2s ease;
  }

  #postsContainer > div:hover {
    transform: scale(1.01);
  }

  #postsContainer img,
  #postsContainer video {
    margin-top: 10px;
    max-width: 100%;
    border-radius: 8px;
  }

  #postsContainer p {
    margin: 10px 0 0;
    font-size: 14px;
  }

  #postsContainer h3 {
    margin-bottom: 6px;
    color: #333;
  }

  #postsContainer p:last-child {
    font-size: 12px;
    color: #777;
    margin-top: 10px;
  }
</style>

</style>
</head>
<body>
  <header>
    <a href="home.html" class="logo-box">KARDAN</a>

    <nav>
      <div class="nav-container">
        <ul class="left-nav">
          <li><a href="index.html" class="nav-button"><i class="fas fa-home"></i> Home</a></li>
          <li><a href="jobs.html" class="nav-button"><i class="fas fa-briefcase"></i> Jobs</a></li>
          <li><a href="buy-books.html" class="nav-button"><i class="fas fa-book"></i> Buy Books</a></li>
          <li><a href="profile.html" class="nav-button"><i class="fas fa-user"></i> Profile</a></li>
          <li><a href="#companies" class="nav-button"><i class="fas fa-building"></i> Companies</a></li>
        </ul>
        <ul class="right-nav">
          <li><a href="#contact" class="nav-button"><i class="fas fa-envelope"></i> Contact</a></li>
          <li><a href="signin.html" class="nav-button"><i class="fas fa-sign-in-alt"></i> Login</a></li>
          <li><a href="signup.html" class="join-button"><i class="fas fa-user-plus"></i> Join Now</a></li>
        </ul>
      </div>
    </nav>
  </header>

  <div class="button-section">
    <a href="jobs.html" class="action-button find-button"><i class="fas fa-search"></i> Find Jobs</a>
    <a href="post-job.html" class="action-button post-button"><i class="fas fa-plus-circle"></i> Post a Job</a>
  </div>

  <div class="post-box">
    <h2 style="color:#3742fa"><i class="fas fa-edit"></i> Create a Post</h2>
    <textarea id="postText" rows="2" placeholder="What's on your mind?"></textarea>
    <input type="file" id="postMedia" accept="image/*,video/*">
    <button onclick="submitPost()" class="post-btn"><i class="fas fa-paper-plane"></i> Post</button>
  </div>

  <div id="postsContainer" style="max-width:600px; margin:40px auto;"></div>

  <!-- Firebase SDK & Post Logic -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
      authDomain: "kar-kardan.firebaseapp.com",
      projectId: "kar-kardan",
      storageBucket: "kar-kardan.appspot.com",
      messagingSenderId: "554147696994",
      appId: "1:554147696994:web:221dcb883e3b65dcea5c3b",
      measurementId: "G-RRC3X485KQ"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    let currentUser = null;
    auth.onAuthStateChanged(user => {
      currentUser = user;
    });

    function submitPost() {
      if (!currentUser) {
        alert("You need to be logged in to post.");
        return;
      }

      const postText = document.getElementById('postText').value;
      const file = document.getElementById('postMedia').files[0];

      if (!postText && !file) {
        return alert("Please write something or upload a media.");
      }

      const postRef = db.collection("posts").doc();

      const savePost = (mediaURL = null, mediaType = null) => {
        postRef.set({
          userId: currentUser.uid,
          userName: currentUser.displayName || "Anonymous",
          text: postText,
          mediaURL,
          mediaType,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
          document.getElementById('postText').value = "";
          document.getElementById('postMedia').value = "";
          alert("Post successfully created!");
        }).catch(error => {
          console.error("Error creating post:", error);
          alert("There was an error posting your content.");
        });
      };

      if (file) {
        const fileRef = storage.ref("posts/" + postRef.id + "_" + file.name);
        fileRef.put(file).then(snapshot => {
          snapshot.ref.getDownloadURL().then(url => {
            const mediaType = file.type.startsWith("image") ? "image" : "video";
            savePost(url, mediaType);
          });
        }).catch(error => {
          console.error("File upload failed:", error);
          alert("File upload failed.");
        });
      } else {
        savePost();
      }
    }

    db.collection("posts").orderBy("timestamp", "desc").onSnapshot(snapshot => {
      const container = document.getElementById("postsContainer");
      container.innerHTML = "";
      snapshot.forEach(doc => {
        const post = doc.data();
        let time = "Just now";
        if (post.timestamp?.toDate) {
          time = post.timestamp.toDate().toLocaleString();
        }

        let mediaContent = "";
        if (post.mediaType === "image") {
          mediaContent = `<img src="${post.mediaURL}" alt="Post image">`;
        } else if (post.mediaType === "video") {
          mediaContent = `
            <video controls>
              <source src="${post.mediaURL}" type="video/mp4">
              Your browser does not support the video tag.
            </video>`;
        }

        container.innerHTML += `
          <div class="bg-white p-4 rounded shadow" style="background:#fff; padding:15px; border-radius:10px; margin-bottom:20px; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
            <h3 style="font-weight:bold;">${post.userName}</h3>
            <p>${post.text}</p>
            ${mediaContent}
            <p style="font-size:12px; color:#777; margin-top:10px;">${time}</p>
          </div>
        `;
      });
    }, error => {
      console.error("Snapshot listener error:", error);
    });
  </script>
</body>
</html>
