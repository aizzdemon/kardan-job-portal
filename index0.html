<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BooterSpace</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
body { background-color: #f8fafc; }
.blink-new { animation: blink 1s infinite ease-in-out; }
@keyframes blink { 0%,50%,100% { opacity:1; } 25%,75% { opacity:0; } }
.tab-button { padding:0.5rem 1rem; border-radius:0.5rem; font-semibold; }
.tab-active { background-color:#3B82F6; color:white; }
.tab-inactive { background-color:#E5E7EB; color:#6B7280; cursor:pointer; }
</style>
</head>
<body class="font-sans antialiased text-gray-900 bg-gray-50">

<!-- Navbar -->
<div id="navbar"></div>
<script>
fetch("navbar.html")
  .then(res => res.text())
  .then(html => {
    document.getElementById("navbar").innerHTML = html;
    const s = document.createElement("script");
    s.type = "module";
    s.src = "navbar.js";
    document.body.appendChild(s);
  });
</script>

<!-- Header -->
<header class="bg-white border-b border-gray-200 py-10">
  <div class="max-w-7xl mx-auto px-4 text-center">
    <h1 class="text-3xl font-black tracking-tight text-gray-900 sm:text-4xl">
      Booter<span class="text-blue-600">Space</span>
    </h1>
    <p class="mt-2 text-sm text-gray-500 max-w-md mx-auto">
      Explore your career opportunities and community posts
    </p>
  </div>
</header>

<!-- Tabs -->
<div class="max-w-7xl mx-auto mt-6 px-4 flex gap-3 justify-center">
  <div id="btn-featured" class="tab-button tab-active" onclick="switchTab('featured')">Featured Jobs</div>
  <div id="btn-govt" class="tab-button tab-inactive" onclick="switchTab('govt')">Govt. Jobs</div>
  <div id="btn-updates" class="tab-button tab-inactive" onclick="switchTab('updates')">Updates</div>
  <div id="btn-community" class="tab-button tab-inactive" onclick="switchTab('community')">Community</div>
</div>

<!-- Tab Panels -->
<main class="max-w-7xl mx-auto py-8 px-4 sm:px-6">

  <!-- Featured Jobs -->
  <div id="featured" class="tab-content">
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
      <div id="featured-jobs" class="flex-grow"></div>
      <button onclick="window.location.href='featured.html'" class="mt-2 py-2 px-4 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700">Load More</button>
    </div>
  </div>

  <!-- Govt Jobs -->
  <div id="govt" class="tab-content hidden">
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
      <div id="govt-jobs" class="flex-grow"></div>
      <button onclick="window.location.href='govt.html'" class="mt-2 py-2 px-4 bg-orange-500 text-white font-bold rounded-lg hover:bg-orange-600">Load More</button>
    </div>
  </div>

  <!-- Updates -->
  <div id="updates" class="tab-content hidden">
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
      <div id="latest-updates" class="flex-grow"></div>
      <button onclick="window.location.href='updates.html'" class="mt-2 py-2 px-4 bg-yellow-400 text-white font-bold rounded-lg hover:bg-yellow-500">Load More</button>
    </div>
  </div>

  <!-- Community -->
  <div id="community" class="tab-content hidden">
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
      <div id="community-posts" class="flex-grow"></div>
      <button onclick="window.location.href='community.html'" class="mt-2 py-2 px-4 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700">Load More</button>
    </div>
  </div>

</main>

<!-- Footer -->
<footer class="mt-12 py-8 text-center">
  <p class="text-gray-400 text-[10px] font-bold uppercase tracking-widest">¬© 2026 BooterSpace</p>
</footer>

<!-- Tab Switching -->
<script>
function switchTab(tab){
  document.querySelectorAll('.tab-content').forEach(el=>el.classList.add('hidden'));
  document.querySelectorAll('.tab-button').forEach(btn=>btn.classList.replace('tab-active','tab-inactive'));
  document.getElementById(tab).classList.remove('hidden');
  document.getElementById(`btn-${tab}`).classList.replace('tab-inactive','tab-active');
}
</script>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy, limit, where } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";
import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
  authDomain: "kar-kardan.firebaseapp.com",
  projectId: "kar-kardan",
  storageBucket: "kar-kardan.firebasestorage.app",
  messagingSenderId: "554147696994",
  appId: "1:554147696994:web:221dcb883e3b65dcea5c3b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

async function init() {
  try { await signInAnonymously(auth); } 
  catch(e){ console.warn("Auth failed", e); }

  const containers = {
    featured: document.getElementById("featured-jobs"),
    govt: document.getElementById("govt-jobs"),
    updates: document.getElementById("latest-updates"),
    community: document.getElementById("community-posts")
  };

  // --- Featured Jobs ---
  try {
    const q = query(collection(db,"jobs"), where("status","==","approved"), orderBy("timestamp","desc"), limit(4));
    const snapshot = await getDocs(q);
    containers.featured.innerHTML = '';
    if(snapshot.empty) containers.featured.innerHTML = `<div class="p-4 text-center text-gray-400 text-xs">No jobs found</div>`;
    else snapshot.forEach(doc=>{
      const job = doc.data();
      const id = doc.id;
      const logo = job.companyImageUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(job.company||'C')}&background=random`;
      containers.featured.innerHTML += `
        <a href="job-detail.html?id=${id}" class="group block p-4 hover:bg-blue-50/50 transition-all border-b border-gray-50 last:border-0 relative">
          <div class="flex items-center gap-3">
            <img src="${logo}" class="w-10 h-10 rounded-lg object-cover border border-gray-100 bg-white flex-shrink-0">
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2">
                <h3 class="text-sm font-bold text-gray-900 truncate">${job.title}</h3>
                <span class="blink-new text-[9px] font-black text-blue-600 bg-blue-100 px-1 rounded">NEW</span>
              </div>
              <p class="text-xs text-gray-500 truncate">${job.company}</p>
            </div>
            <svg class="w-4 h-4 text-gray-300 group-hover:text-blue-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
        </a>`;
    });
  } catch(e){ console.error(e); }

  // --- Govt Jobs ---
  try {
    const q = query(collection(db,"govtJobs"), orderBy("timestamp","desc"), limit(4));
    const snapshot = await getDocs(q);
    containers.govt.innerHTML = '';
    if(snapshot.empty) containers.govt.innerHTML = `<div class="p-4 text-center text-gray-400 text-xs">No notifications</div>`;
    else snapshot.forEach(doc=>{
      const job = doc.data();
      const id = doc.id;
      const logo = job.companyImageUrl || "https://img.icons8.com/color/96/government-buildings.png";
      containers.govt.innerHTML += `
        <a href="job-detail.html?id=${id}" class="group block p-4 hover:bg-orange-50/50 transition-all border-b border-gray-50 last:border-0 relative">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg bg-orange-50 flex items-center justify-center flex-shrink-0">
              <img src="${logo}" class="w-6 h-6 object-contain">
            </div>
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2">
                <h3 class="text-sm font-bold text-gray-900 truncate">${job.title}</h3>
                <span class="blink-new text-[9px] font-black text-orange-600 bg-orange-100 px-1 rounded">NEW</span>
              </div>
              <p class="text-xs text-orange-600 font-medium truncate">${job.companyName||"Govt Sector"}</p>
            </div>
            <svg class="w-4 h-4 text-gray-300 group-hover:text-orange-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
        </a>`;
    });
  } catch(e){ console.error(e); }

  // --- Updates ---
  try {
    const q = query(collection(db,"flashLinks"), orderBy("timestamp","desc"), limit(4));
    const snapshot = await getDocs(q);
    containers.updates.innerHTML = '';
    snapshot.forEach(doc=>{
      const item = doc.data();
      containers.updates.innerHTML += `
        <a href="${item.url}" target="_blank" class="group block p-4 hover:bg-yellow-50/50 transition-all border-b border-gray-50 last:border-0">
          <div class="flex items-start gap-3">
            <span class="text-yellow-500 mt-0.5">‚ö°</span>
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <span class="text-xs font-bold text-gray-800 group-hover:text-blue-700 leading-tight line-clamp-1">${item.title}</span>
                <span class="blink-new text-[9px] font-black text-yellow-700 bg-yellow-100 px-1 rounded">NEW</span>
              </div>
              <p class="text-[10px] text-gray-400">Update received just now</p>
            </div>
          </div>
        </a>`;
    });
  } catch(e){ console.error(e); }

  // --- Community ---
  try {
    const q = query(collection(db,"communityPosts"), orderBy("timestamp","desc"), limit(4));
    const snapshot = await getDocs(q);
    containers.community.innerHTML = '';
    if(snapshot.empty) containers.community.innerHTML = `<div class="p-4 text-center text-gray-400 text-xs">No posts yet</div>`;
    else snapshot.forEach(doc=>{
      const post = doc.data();
      containers.community.innerHTML += `
        <div class="p-4 border-b border-gray-100 hover:bg-gray-50 transition-all">
          <p class="text-xs text-gray-600">${post.userName||'Anonymous'}</p>
          <p class="text-sm text-gray-800 mt-1">${post.content}</p>
          <div class="flex gap-4 mt-2 text-[10px] text-gray-500">
            <span>üëç ${post.likes||0}</span>
            <span>üëé ${post.dislikes||0}</span>
          </div>
        </div>`;
    });
  } catch(e){ console.error(e); }

}

window.addEventListener("DOMContentLoaded", init);
</script>

</body>
</html>
