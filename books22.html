<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>KARDAN â€“ Buy Books Online</title>

<meta name="description" content="Buy books online from KARDAN. Browse the latest collection of educational, fiction, non-fiction, and competitive exam books in India.">

<script src="https://cdn.tailwindcss.com"></script>
<link rel="icon" href="assets/logo.png"/>

</head>
<body class="bg-gray-100">

<!-- NAVBAR -->
<div id="navbar"></div>

<!-- HEADER -->
<header class="bg-blue-600 text-white p-6 text-center shadow">
  <h1 class="text-3xl font-bold">ðŸ“š KARDAN Book Store</h1>
  <p class="opacity-90">Buy Educational, Fiction & Competitive Exam Books</p>
</header>

<!-- BOOKS -->
<div class="max-w-6xl mx-auto p-6">

  <input id="bookSearch" placeholder="Search books by title or author..."
    class="w-full p-3 border rounded mb-4"/>

  <div id="suggestions" class="bg-white border rounded shadow mb-4 hidden"></div>

  <div id="booksContainer" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>

</div>

<!-- NAVBAR LOAD -->
<script type="module">
fetch("navbar.html")
  .then(r=>r.text())
  .then(html=>{
    document.getElementById("navbar").innerHTML = html;
    const s = document.createElement("script");
    s.type="module";
    s.src="navbar.js";
    document.body.appendChild(s);
  });
</script>

<!-- ================= FIREBASE v10 ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
  authDomain: "kar-kardan.firebaseapp.com",
  projectId: "kar-kardan",
  storageBucket: "kar-kardan.firebasestorage.app",
  messagingSenderId: "554147696994",
  appId: "1:554147696994:web:221dcb883e3b65dcea5c3b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const booksContainer = document.getElementById("booksContainer");
const searchInput = document.getElementById("bookSearch");
const suggestionsBox = document.getElementById("suggestions");

let allBooks = [];
let keywords = new Set();

const q = query(collection(db,"books"), orderBy("timestamp","desc"));

onSnapshot(q, snap=>{
  allBooks = [];
  keywords.clear();
  booksContainer.innerHTML="";

  snap.forEach(doc=>{
    const b = doc.data();
    allBooks.push(b);
    if(b.title) keywords.add(b.title);
    if(b.author) keywords.add(b.author);
    renderBook(b);
  });
});

function renderBook(b){
  booksContainer.innerHTML += `
  <div class="bg-white p-4 rounded shadow hover:shadow-lg">
    <img src="${b.photo || 'https://via.placeholder.com/300x200'}" class="h-48 w-full object-cover rounded mb-3">
    <h3 class="font-bold text-lg">${b.title}</h3>
    <p class="text-sm text-gray-600">${b.author || 'Unknown Author'}</p>
    <p class="mt-2 font-bold">â‚¹${b.price || 'N/A'}</p>
    <a href="${b.link || '#'}" target="_blank" class="block mt-3 bg-blue-600 text-white text-center py-2 rounded">Buy Now</a>
  </div>`;
}

searchInput.addEventListener("input",()=>{
  const v = searchInput.value.toLowerCase();
  booksContainer.innerHTML="";

  if(!v){
    allBooks.forEach(renderBook);
    suggestionsBox.classList.add("hidden");
    return;
  }

  const match = [...keywords].filter(k=>k.toLowerCase().includes(v));
  suggestionsBox.innerHTML="";
  match.slice(0,6).forEach(k=>{
    const d=document.createElement("div");
    d.className="p-2 hover:bg-gray-100 cursor-pointer";
    d.textContent=k;
    d.onclick=()=>{
      searchInput.value=k;
      suggestionsBox.classList.add("hidden");
    };
    suggestionsBox.appendChild(d);
  });

  suggestionsBox.classList.remove("hidden");

  allBooks.filter(b=>
    (b.title && b.title.toLowerCase().includes(v)) ||
    (b.author && b.author.toLowerCase().includes(v))
  ).forEach(renderBook);
});
</script>

</body>
</html>
