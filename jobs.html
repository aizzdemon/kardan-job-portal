<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BooterSpace | Jobs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>

</head>
<body class="bg-gray-100">

<!-- NAVBAR -->
<div id="navbar"></div>

<!-- HEADER -->
<header class="bg-blue-600 text-white p-6 text-center shadow">
  <h1 class="text-3xl font-bold">Latest Jobs</h1>
  <p class="opacity-90">Find your dream career at BooterSpace</p>
</header>

<!-- JOBS -->
<div id="jobsContainer" class="max-w-7xl mx-auto p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>

<!-- NAVBAR LOAD -->
<script type="module">
fetch("navbar.html")
  .then(res => res.text())
  .then(html => {
    document.getElementById("navbar").innerHTML = html;
    const s = document.createElement("script");
    s.type = "module";
    s.src = "navbar.js";
    document.body.appendChild(s);
  });
</script>

<!-- ================= FIREBASE v10 ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getFirestore, collection, query, where, orderBy, getDocs } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
  authDomain: "kar-kardan.firebaseapp.com",
  projectId: "kar-kardan",
  storageBucket: "kar-kardan.firebasestorage.app",
  messagingSenderId: "554147696994",
  appId: "1:554147696994:web:221dcb883e3b65dcea5c3b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const jobsContainer = document.getElementById("jobsContainer");

async function loadJobs(){
  jobsContainer.innerHTML = "<p class='text-center col-span-3'>Loading jobs...</p>";

  const q = query(
    collection(db,"jobs"),
    where("status","==","approved"),
    orderBy("createdAt","desc")
  );

  const snapshot = await getDocs(q);

  jobsContainer.innerHTML = "";

  if(snapshot.empty){
    jobsContainer.innerHTML = "<p class='text-center col-span-3'>No jobs found</p>";
    return;
  }

  snapshot.forEach(doc=>{
    const job = doc.data();

    jobsContainer.innerHTML += `
      <div class="bg-white rounded-lg shadow p-5 hover:shadow-lg transition">
        <h3 class="font-bold text-xl text-blue-600">${job.title}</h3>
        <p class="text-sm text-gray-600 mt-1">${job.company}</p>
        <p class="text-sm mt-2">üìç ${job.location}</p>
        <p class="text-sm mt-1">üí∞ ${job.salary || "Not disclosed"}</p>

        <a href="job-detail.html?id=${doc.id}" class="block mt-4 text-center bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
          View Job
        </a>
      </div>
    `;
  });
}

loadJobs();
</script>

</body>
</html>
