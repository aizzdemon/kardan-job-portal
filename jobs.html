<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jobs in India | KARDAN Job Portal</title>
  
  <!-- SEO Meta Tags -->
  <meta name="description" content="Find latest job openings in India. Search by job title, company, or location. Apply now on KARDAN Job Portal.">
  <meta name="keywords" content="Jobs in India, IT Jobs, Sales Jobs, Marketing Jobs, Software Engineer Jobs, HR Jobs, KARDAN job portal">
  <meta name="author" content="KARDAN">

  <!-- Open Graph -->
  <meta property="og:title" content="Jobs in India | KARDAN Job Portal">
  <meta property="og:description" content="Discover job opportunities across India. Search and apply with KARDAN.">
  <meta property="og:image" content="https://aizzdemon.github.io/kardan-job-portal/assets/logo.png">
  <meta property="og:url" content="https://aizzdemon.github.io/kardan-job-portal/jobs.html">
  <meta property="og:type" content="website">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "JobPosting",
    "title": "Find Jobs in India",
    "description": "Search latest jobs across India including IT, Sales, HR, Marketing and more.",
    "hiringOrganization": {
      "@type": "Organization",
      "name": "KARDAN",
      "sameAs": "https://aizzdemon.github.io/kardan-job-portal/"
    },
    "jobLocation": {
      "@type": "Place",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "IN"
      }
    }
  }
  </script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  
  <!-- Header -->
  <header class="bg-white shadow p-4 flex justify-between items-center">
    <a href="index.html" class="text-2xl font-bold text-blue-600">KARDAN</a>
    <nav class="space-x-4">
      <a href="index.html" class="hover:text-blue-600">Home</a>
      <a href="jobs.html" class="hover:text-blue-600">Jobs</a>
      <a href="companies.html" class="hover:text-blue-600">Companies</a>
      <a href="places-to-hangout.html" class="hover:text-blue-600">Hangouts</a>
    </nav>
  </header>

  <!-- Search Filters -->
  <section class="p-6 bg-blue-50">
    <div class="max-w-5xl mx-auto grid grid-cols-1 sm:grid-cols-2 gap-4">
      <!-- Job Title Search -->
      <div class="relative">
        <input id="filterKeyword" type="text" 
               placeholder="Search by Job Title or Company" 
               class="border p-3 rounded w-full" 
               autocomplete="off">
        <div id="keywordSuggestions" class="absolute bg-white border w-full rounded shadow hidden max-h-40 overflow-y-auto z-10"></div>
      </div>
      
      <!-- Location Search -->
      <div class="relative">
        <input id="filterLocation" type="text" 
               placeholder="Filter by Location" 
               class="border p-3 rounded w-full" 
               autocomplete="off">
        <div id="locationSuggestions" class="absolute bg-white border w-full rounded shadow hidden max-h-40 overflow-y-auto z-10"></div>
      </div>
    </div>
  </section>

  <!-- Job Listings -->
  <main class="max-w-5xl mx-auto p-6">
    <h1 class="text-2xl font-semibold mb-4">Latest Jobs in India</h1>
    <div id="jobList" class="space-y-4"></div>
  </main>

  <!-- Firebase Config -->
  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
    authDomain: "kar-kardan.firebaseapp.com",
    projectId: "kar-kardan",
    storageBucket: "kar-kardan.firebasestorage.app",
    messagingSenderId: "554147696994",
    appId: "1:554147696994:web:221dcb883e3b65dcea5c3b"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  </script>

  <!-- Job Script -->
  <script>
  const jobList = document.getElementById("jobList");
  const filterKeyword = document.getElementById("filterKeyword");
  const filterLocation = document.getElementById("filterLocation");
  const keywordSuggestions = document.getElementById("keywordSuggestions");
  const locationSuggestions = document.getElementById("locationSuggestions");

  let jobTitles = new Set();
  let jobLocations = new Set();
  const defaultCities = ["Delhi", "Mumbai", "Bengaluru", "Hyderabad", "Chennai", "Kolkata", "Pune", "Ahmedabad", "Jaipur"];

  // Fetch jobs
  async function loadJobs(search = false) {
    jobList.innerHTML = "<p>Loading jobs...</p>";
    let snapshot = await db.collection("jobs").orderBy("timestamp", "desc").get();
    jobList.innerHTML = "";
    
    snapshot.forEach(doc => {
      const job = doc.data();
      if (job.title) jobTitles.add(job.title);
      if (job.company) jobTitles.add(job.company);
      if (job.location) jobLocations.add(job.location);

      let match = true;
      if (search) {
        if (filterKeyword.value && !job.title.toLowerCase().includes(filterKeyword.value.toLowerCase()) && !job.company.toLowerCase().includes(filterKeyword.value.toLowerCase())) {
          match = false;
        }
        if (filterLocation.value && !job.location.toLowerCase().includes(filterLocation.value.toLowerCase())) {
          match = false;
        }
      }
      if (match) {
        const card = document.createElement("div");
        card.className = "p-4 bg-white rounded-lg shadow hover:shadow-md";
        card.innerHTML = `
          <h2 class="text-lg font-bold">${job.title}</h2>
          <p class="text-gray-600">${job.company}</p>
          <p class="text-gray-500">${job.location}</p>
          <a href="job-detail.html?id=${doc.id}" class="text-blue-600 hover:underline">View Details</a>
        `;
        jobList.appendChild(card);
      }
    });
  }

  // Suggestion rendering
  function renderSuggestions(inputEl, suggestionsEl, dataSet) {
    const val = inputEl.value.toLowerCase();
    suggestionsEl.innerHTML = "";
    if (!val) {
      suggestionsEl.classList.add("hidden");
      return;
    }
    let matched = [...dataSet].filter(item => item.toLowerCase().includes(val));
    matched.slice(0, 8).forEach(item => {
      const option = document.createElement("div");
      option.className = "px-3 py-2 hover:bg-blue-100 cursor-pointer";
      option.textContent = item;
      option.onclick = () => {
        inputEl.value = item;
        suggestionsEl.classList.add("hidden");
        loadJobs(true);
      };
      suggestionsEl.appendChild(option);
    });
    if (matched.length > 0) {
      suggestionsEl.classList.remove("hidden");
    } else {
      suggestionsEl.classList.add("hidden");
    }
  }

  filterKeyword.addEventListener("input", () => renderSuggestions(filterKeyword, keywordSuggestions, jobTitles));
  filterLocation.addEventListener("input", () => renderSuggestions(filterLocation, locationSuggestions, new Set([...jobLocations, ...defaultCities])));

  document.addEventListener("click", (e) => {
    if (!keywordSuggestions.contains(e.target) && e.target !== filterKeyword) keywordSuggestions.classList.add("hidden");
    if (!locationSuggestions.contains(e.target) && e.target !== filterLocation) locationSuggestions.classList.add("hidden");
  });

  loadJobs();
  </script>
</body>
</html>
