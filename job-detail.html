<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KARDAN Job Details</title>
  <meta name="description" content="Find detailed job descriptions, company information, requirements, perks, and apply directly on KARDAN Job Portal." />
  <meta name="keywords" content="jobs, careers, inside sales, marathi jobs, healthcare jobs, work from home, kardan job portal" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"></script>
  <script src="https://unpkg.com/lucide-icons/dist/umd/lucide.min.js"></script>
</head>
<body class="bg-gray-100 text-gray-900">

  <!-- üîπ Navigation Bar -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <!-- Logo -->
      <a href="index.html" class="text-2xl font-bold text-blue-600 flex items-center space-x-2">
        <span>KARDAN</span>
      </a>

      <!-- Nav Buttons -->
      <div class="flex space-x-6 text-gray-700 font-medium">
        <a href="index.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="home" class="w-5 h-5"></i><span>Home</span>
        </a>
        <a href="jobs.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="briefcase" class="w-5 h-5"></i><span>Jobs</span>
        </a>
        <a href="books.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="book-open" class="w-5 h-5"></i><span>Buy Books</span>
        </a>
        <a href="places-to-hangout.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="map-pin" class="w-5 h-5"></i><span>Hangouts</span>
        </a>
        <a href="companies.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="building-2" class="w-5 h-5"></i><span>Companies</span>
        </a>
        <a href="login.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="log-in" class="w-5 h-5"></i><span>Login</span>
        </a>
        <a href="signup.html" class="flex items-center space-x-1 hover:text-blue-600">
          <i data-lucide="user-plus" class="w-5 h-5"></i><span>Join Now</span>
        </a>
      </div>
    </div>
  </nav>

  <!-- üîπ Job Details Container -->
  <div class="max-w-3xl mx-auto bg-white shadow-lg rounded-lg p-6 my-10">
    
    <!-- Logo -->
    <div class="flex justify-center mb-6">
      <img id="companyLogo" src="" alt="Company Logo" class="w-28 h-28 object-contain rounded-lg shadow hidden">
    </div>

    <!-- Job Title -->
    <h1 id="jobTitle" class="text-3xl font-bold text-center mb-2">Loading...</h1>
    <p id="companyName" class="text-center text-gray-600 mb-6"></p>

    <!-- Published Date -->
    <p id="publishedDate" class="text-sm text-gray-500 text-center mb-8"></p>

    <!-- About the Company -->
    <div id="aboutCompanySection" class="mb-6 hidden">
      <h2 class="text-xl font-semibold mb-2">About the Company</h2>
      <p id="aboutCompany" class="text-gray-700"></p>
    </div>

    <!-- Job Summary -->
    <div id="jobSummarySection" class="mb-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Job Summary</h2>
      <p id="jobSummary" class="text-gray-700"></p>
    </div>

    <!-- Key Responsibilities -->
    <div id="responsibilitiesSection" class="mb-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Key Responsibilities</h2>
      <ul id="responsibilitiesList" class="list-disc pl-6 text-gray-700"></ul>
    </div>

    <!-- Requirements -->
    <div id="requirementsSection" class="mb-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Requirements</h2>
      <ul id="requirementsList" class="list-disc pl-6 text-gray-700"></ul>
    </div>

    <!-- Perks & Benefits -->
    <div id="benefitsSection" class="mb-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Perks & Benefits</h2>
      <ul id="benefitsList" class="list-disc pl-6 text-gray-700"></ul>
    </div>

    <!-- Timings & Additional Info -->
    <div id="timingsSection" class="mb-6 hidden">
      <h2 class="text-xl font-semibold mb-2">Timings & Additional Info</h2>
      <p id="timingsInfo" class="text-gray-700"></p>
    </div>

    <!-- Apply Button -->
    <div class="text-center mt-8 hidden" id="applyBtnSection">
      <a id="applyLink" href="#" target="_blank" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition">Apply Now</a>
    </div>

    <!-- Fallback Error -->
    <div id="errorMessage" class="text-center text-red-600 font-semibold mt-6 hidden">
      ‚ùå Job not found or details unavailable.
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
      authDomain: "kar-kardan.firebaseapp.com",
      projectId: "kar-kardan",
      storageBucket: "kar-kardan.firebasestorage.app",
      messagingSenderId: "554147696994",
      appId: "1:554147696994:web:221dcb883e3b65dcea5c3b",
      measurementId: "G-RRC3X485KQ"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadJobDetails() {
      const params = new URLSearchParams(window.location.search);
      const jobId = params.get("id");

      if (!jobId) {
        document.getElementById("errorMessage").classList.remove("hidden");
        document.getElementById("jobTitle").textContent = "Invalid Job ID";
        return;
      }

      try {
        const docRef = doc(db, "jobs", jobId);
        const docSnap = await getDoc(docRef);

        if (!docSnap.exists()) {
          document.getElementById("errorMessage").classList.remove("hidden");
          document.getElementById("jobTitle").textContent = "Job Not Found";
          return;
        }

        const job = docSnap.data();
        console.log("Fetched job:", job);

        // Title & company
        document.getElementById("jobTitle").textContent = job.title || "Job Title";
        document.getElementById("companyName").textContent = 
          `${job.company || "Company"} ‚Ä¢ ${job.location || "Location"}`;

        // Published date
        if (job.timestamp && job.timestamp.toDate) {
          document.getElementById("publishedDate").textContent =
            `Posted on ${new Date(job.timestamp.toDate()).toDateString()}`;
        }

        // Logo
        if (job.logo) {
          const logoEl = document.getElementById("companyLogo");
          logoEl.src = job.logo;
          logoEl.classList.remove("hidden");
        }

        // About company
        if (job.aboutCompany) {
          document.getElementById("aboutCompany").textContent = job.aboutCompany;
          document.getElementById("aboutCompanySection").classList.remove("hidden");
        }

        // Summary
        if (job.summary) {
          document.getElementById("jobSummary").textContent = job.summary;
          document.getElementById("jobSummarySection").classList.remove("hidden");
        }

        // Responsibilities
        if (Array.isArray(job.responsibilities) && job.responsibilities.length) {
          job.responsibilities.forEach(r => {
            const li = document.createElement("li");
            li.textContent = r;
            document.getElementById("responsibilitiesList").appendChild(li);
          });
          document.getElementById("responsibilitiesSection").classList.remove("hidden");
        }

        // Requirements
        if (Array.isArray(job.requirements) && job.requirements.length) {
          job.requirements.forEach(r => {
            const li = document.createElement("li");
            li.textContent = r;
            document.getElementById("requirementsList").appendChild(li);
          });
          document.getElementById("requirementsSection").classList.remove("hidden");
        }

        // Benefits
        if (Array.isArray(job.benefits) && job.benefits.length) {
          job.benefits.forEach(b => {
            const li = document.createElement("li");
            li.textContent = b;
            document.getElementById("benefitsList").appendChild(li);
          });
          document.getElementById("benefitsSection").classList.remove("hidden");
        }

        // Timings
        if (job.timings) {
          document.getElementById("timingsInfo").textContent = job.timings;
          document.getElementById("timingsSection").classList.remove("hidden");
        }

        // Apply link
        if (job.applyLink) {
          document.getElementById("applyLink").href = job.applyLink;
          document.getElementById("applyBtnSection").classList.remove("hidden");
        }

        // SEO update
        if (job.title && job.company) {
          document.title = `${job.title} at ${job.company} - KARDAN Job Portal`;
          document.querySelector('meta[name="description"]').setAttribute(
            "content",
            `${job.title} role at ${job.company}. ${job.summary || "Apply now on KARDAN."}`
          );
        }

      } catch (error) {
        console.error("Error fetching job:", error);
        document.getElementById("errorMessage").classList.remove("hidden");
        document.getElementById("jobTitle").textContent = "Error loading job";
      }
    }

    loadJobDetails();

    // Load icons
    lucide.createIcons();
  </script>
</body>
</html>
