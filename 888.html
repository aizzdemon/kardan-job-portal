<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BooterSpace</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase Init (GLOBAL for navbar.js + all pages) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getAuth } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
  authDomain: "kar-kardan.firebaseapp.com",
  projectId: "kar-kardan",
  storageBucket: "kar-kardan.firebasestorage.app",
  messagingSenderId: "554147696994",
  appId: "1:554147696994:web:221dcb883e3b65dcea5c3b"
};

const app = initializeApp(firebaseConfig);
window.auth = getAuth(app);
window.db = getFirestore(app);
</script>

<!-- Page Data Loader -->
<script type="module">
import { collection, query, where, orderBy, limit, getDocs } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

const db = window.db;

window.addEventListener("DOMContentLoaded", async () => {

  const featured = document.getElementById("featured-jobs");
  const govt = document.getElementById("govt-jobs");
  const updates = document.getElementById("latest-updates");
  const community = document.getElementById("community-posts");

  // Featured Jobs
  const q1 = query(collection(db,"jobs"), where("status","==","approved"), orderBy("timestamp","desc"), limit(4));
  const s1 = await getDocs(q1);
  featured.innerHTML="";
  s1.forEach(d=>{
    const j=d.data();
    featured.innerHTML+=`<a href="job-detail.html?id=${d.id}" class="block p-4 border-b hover:bg-blue-50">
      <b>${j.title}</b><p class="text-xs">${j.company}</p></a>`;
  });

  // Govt Jobs
  const q2 = query(collection(db,"govtJobs"), orderBy("timestamp","desc"), limit(4));
  const s2 = await getDocs(q2);
  govt.innerHTML="";
  s2.forEach(d=>{
    const j=d.data();
    govt.innerHTML+=`<div class="p-4 border-b"><b>${j.title}</b></div>`;
  });

  // Updates
  const q3 = query(collection(db,"flashLinks"), orderBy("timestamp","desc"), limit(4));
  const s3 = await getDocs(q3);
  updates.innerHTML="";
  s3.forEach(d=>{
    const j=d.data();
    updates.innerHTML+=`<a href="${j.url}" target="_blank" class="block p-4 border-b">${j.title}</a>`;
  });

  // Community
  const q4 = query(collection(db,"communityPosts"), orderBy("timestamp","desc"), limit(4));
  const s4 = await getDocs(q4);
  community.innerHTML="";
  s4.forEach(d=>{
    const j=d.data();
    community.innerHTML+=`<div class="p-4 border-b">
      <b>${j.userName}</b><p>${j.content}</p>
      üëç${j.likes||0} üëé${j.dislikes||0}
    </div>`;
  });

});
</script>

<style>
.tab-button{padding:.5rem 1rem;border-radius:.5rem;font-weight:bold}
.tab-active{background:#3B82F6;color:white}
.tab-inactive{background:#E5E7EB;color:#555;cursor:pointer}
</style>
</head>

<body class="bg-gray-100">

<!-- Navbar -->
<div id="navbar"></div>
<script>
fetch("navbar.html").then(r=>r.text()).then(html=>{
  document.getElementById("navbar").innerHTML=html;
  const s=document.createElement("script");
  s.type="module"; s.src="navbar.js"; document.body.appendChild(s);
});
</script>

<div class="max-w-6xl mx-auto mt-6 px-4">
  <div class="flex gap-2 justify-center mb-4">
    <div id="btn-featured" class="tab-button tab-active" onclick="switchTab('featured')">Featured</div>
    <div id="btn-govt" class="tab-button tab-inactive" onclick="switchTab('govt')">Govt</div>
    <div id="btn-updates" class="tab-button tab-inactive" onclick="switchTab('updates')">Updates</div>
    <div id="btn-community" class="tab-button tab-inactive" onclick="switchTab('community')">Community</div>
  </div>

  <div id="featured" class="tab-content"><div id="featured-jobs" class="bg-white rounded shadow"></div></div>
  <div id="govt" class="tab-content hidden"><div id="govt-jobs" class="bg-white rounded shadow"></div></div>
  <div id="updates" class="tab-content hidden"><div id="latest-updates" class="bg-white rounded shadow"></div></div>
  <div id="community" class="tab-content hidden"><div id="community-posts" class="bg-white rounded shadow"></div></div>
</div>

<script>
function switchTab(tab){
  document.querySelectorAll('.tab-content').forEach(e=>e.classList.add('hidden'));
  document.querySelectorAll('.tab-button').forEach(e=>e.classList.replace('tab-active','tab-inactive'));
  document.getElementById(tab).classList.remove('hidden');
  document.getElementById('btn-'+tab).classList.replace('tab-inactive','tab-active');
}
</script>

</body>
</html>

