<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BooterSpace Navbar</title>

<script src="https://cdn.tailwindcss.com"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

<style>
.nav-link{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:14px;        /* â¬…ï¸ ICON & TEXT BIGGER */
  font-weight:700;
  color:#64748b;
  transition:.25s;
}
.nav-link.active{color:#2563eb}
.nav-link:hover{color:#2563eb}
</style>
</head>

<body class="bg-gray-100">

<!-- NAVBAR -->
<nav class="bg-white border-b sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex justify-between items-center h-16">

      <!-- LOGO -->
      <a href="index.html" class="flex items-center gap-2 font-bold text-xl">
        ğŸš€ BooterSpace
      </a>

      <!-- DESKTOP MENU -->
      <div class="hidden md:flex items-center gap-7">
        <a href="index.html" class="nav-link" data-link>ğŸ  Home</a>
        <a href="jobs.html" class="nav-link" data-link>ğŸ’¼ Jobs</a>
        <a href="govt.html" class="nav-link" data-link>ğŸ› Govt</a>
        <a href="result2025.html" class="nav-link" data-link>ğŸ“„ Result</a>

        <!-- PROFILE -->
        <a href="profile.html" class="nav-link gap-2" data-link>
          <img id="avatar"
               class="w-9 h-9 rounded-full border border-gray-300 object-cover">
          Profile
        </a>

        <a href="dashboard.html" id="dashboardBtn"
           class="nav-link hidden" data-link>
          ğŸ“Š Dashboard
        </a>

        <button id="logoutBtn"
                class="nav-link hidden text-red-500">
          ğŸšª Logout
        </button>
      </div>

      <!-- MOBILE BTN -->
      <button id="menuBtn" class="md:hidden text-2xl">â˜°</button>
    </div>
  </div>

  <!-- MOBILE MENU -->
  <div id="mobileMenu"
       class="hidden md:hidden px-4 py-4 space-y-4 bg-white border-t">
    <a href="index.html" class="nav-link" data-link>ğŸ  Home</a>
    <a href="jobs.html" class="nav-link" data-link>ğŸ’¼ Jobs</a>
    <a href="govt.html" class="nav-link" data-link>ğŸ› Govt</a>
    <a href="result2025.html" class="nav-link" data-link>ğŸ“„ Result</a>
    <a href="profile.html" class="nav-link" data-link>ğŸ‘¤ Profile</a>

    <a href="dashboard.html" id="dashboardMobile"
       class="nav-link hidden" data-link>
      ğŸ“Š Dashboard
    </a>

    <button id="logoutMobile"
            class="nav-link hidden text-red-500">
      ğŸšª Logout
    </button>
  </div>
</nav>

<!-- LOGOUT TOAST -->
<div id="toast"
     class="hidden fixed bottom-6 right-6 bg-black text-white px-4 py-2 rounded shadow z-50">
  Logging out...
</div>

<script>
/* FIREBASE INIT */
firebase.initializeApp({
  apiKey: "AIzaSyBeGZBE1u1hDWbRouchgwkgp89D973I",
  authDomain: "kar-kardan.firebaseapp.com",
  projectId: "kar-kardan"
});

const auth = firebase.auth();
const db = firebase.firestore();

/* ELEMENTS */
const avatar = document.getElementById("avatar");
const dashboardBtn = document.getElementById("dashboardBtn");
const dashboardMobile = document.getElementById("dashboardMobile");
const logoutBtn = document.getElementById("logoutBtn");
const logoutMobile = document.getElementById("logoutMobile");
const menuBtn = document.getElementById("menuBtn");
const mobileMenu = document.getElementById("mobileMenu");
const toast = document.getElementById("toast");

const DEFAULT_AVATAR =
  "https://api.dicebear.com/7.x/bottts/svg?seed=q1ywn";

/* MOBILE MENU */
menuBtn.onclick = () => mobileMenu.classList.toggle("hidden");

/* ACTIVE LINK */
document.querySelectorAll("[data-link]").forEach(link=>{
  if(location.pathname.includes(link.getAttribute("href"))){
    link.classList.add("active");
  }
});

/* AUTH */
auth.onAuthStateChanged(async user=>{
  if(!user) return;

  logoutBtn.classList.remove("hidden");
  logoutMobile.classList.remove("hidden");

  try{
    const doc = await db.collection("users").doc(user.uid).get();
    if(doc.exists){
      const data = doc.data();
      avatar.src = data.photoURL || DEFAULT_AVATAR;

      if(data.role === "job_provider"){
        dashboardBtn.classList.remove("hidden");
        dashboardMobile.classList.remove("hidden");
      }
    }else{
      avatar.src = DEFAULT_AVATAR;
    }
  }catch(e){
    avatar.src = DEFAULT_AVATAR;
  }
});

/* LOGOUT */
function logout(){
  toast.classList.remove("hidden");
  auth.signOut().then(()=>{
    setTimeout(()=>location.href="index.html",1200);
  });
}
logoutBtn.onclick = logoutMobile.onclick = logout;
</script>

</body>
</html>
