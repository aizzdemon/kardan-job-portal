<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BooterSpace Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>

</head>
<body class="bg-gray-100">

<!-- ================= NAVBAR ================= -->
<div class="bg-white shadow p-4 text-xl font-bold text-blue-600">
BooterSpace
</div>

<!-- ================= TABS ================= -->
<div class="flex justify-center gap-4 p-4 bg-white shadow">
<button onclick="openTab('featured')" class="tab-btn">Featured Jobs</button>
<button onclick="openTab('govt')" class="tab-btn">Govt Jobs</button>
<button onclick="openTab('updates')" class="tab-btn">Updates</button>
<button onclick="openTab('community')" class="tab-btn">Community</button>
</div>

<!-- ================= CONTENT ================= -->
<div id="content" class="p-4 max-w-4xl mx-auto"></div>

<!-- ================= FIREBASE ================= -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyBeGZBE1u1-y1hDWbRouchgwkgp89D973I",
 authDomain:"kar-kardan.firebaseapp.com",
 projectId:"kar-kardan",
 storageBucket:"kar-kardan.firebasestorage.app",
 messagingSenderId:"554147696994",
 appId:"1:554147696994:web:221dcb883e3b65dcea5c3b"
});

const db = firebase.firestore();
const content = document.getElementById("content");

function openTab(tab){
 if(tab==="featured") loadFeatured();
 if(tab==="govt") loadGovt();
 if(tab==="updates") loadUpdates();
 if(tab==="community") loadCommunity();
}

/* ============ FEATURED JOBS (4 only) ============ */
async function loadFeatured(){
 const snap = await db.collection("jobs")
 .where("status","==","approved")
 .where("category","==","Featured")
 .orderBy("timestamp","desc")
 .limit(4).get();

 renderJobs(snap.docs.map(d=>d.data()));
}

/* ============ GOVT JOBS ============ */
async function loadGovt(){
 const snap = await db.collection("jobs")
 .where("status","==","approved")
 .where("category","==","Government")
 .orderBy("timestamp","desc")
 .limit(6).get();

 let html = renderJobs(snap.docs.map(d=>d.data()),false);
 html += `<div class="text-center mt-4">
 <button onclick="location.href='govt.html'" class="bg-blue-600 text-white px-4 py-2 rounded">
 Load More Govt Jobs
 </button></div>`;
 content.innerHTML = html;
}

/* ============ UPDATES ============ */
async function loadUpdates(){
 const snap = await db.collection("updates")
 .orderBy("timestamp","desc")
 .limit(10).get();

 let html="";
 snap.forEach(d=>{
  const u=d.data();
  html+=`<div class="bg-white p-4 rounded shadow mb-3">
  <h3 class="font-bold">${u.title}</h3>
  <p class="text-gray-600">${u.description}</p>
  </div>`;
 });
 content.innerHTML=html;
}

/* ============ COMMUNITY ============ */
async function loadCommunity(){
 const snap = await db.collection("community_posts")
 .orderBy("timestamp","desc")
 .limit(20).get();

 let html=`<div class="text-right mb-4">
 <button onclick="location.href='community.html'" class="bg-blue-600 text-white px-4 py-2 rounded">
 Post Now
 </button></div>`;

 snap.forEach(doc=>{
  const p=doc.data();
  html+=`
  <div class="bg-white p-4 rounded shadow mb-3">
  <div class="font-bold">${p.userName}</div>
  <p class="my-2">${p.text}</p>
  <div class="flex gap-4">
   <button onclick="likePost('${doc.id}')">‚ù§Ô∏è ${p.likes||0}</button>
   <button onclick="dislikePost('${doc.id}')">üëé ${p.dislikes||0}</button>
  </div>
  </div>`;
 });

 content.innerHTML=html;
}

/* ============ LIKE / DISLIKE ============ */
function likePost(id){
 db.collection("community_posts").doc(id).update({
  likes: firebase.firestore.FieldValue.increment(1)
 });
 loadCommunity();
}
function dislikePost(id){
 db.collection("community_posts").doc(id).update({
  dislikes: firebase.firestore.FieldValue.increment(1)
 });
 loadCommunity();
}

/* ============ JOB RENDER ============ */
function renderJobs(jobs,auto=true){
 let html="";
 jobs.forEach(j=>{
  html+=`
  <div class="bg-white p-4 rounded shadow mb-3">
   <h3 class="font-bold">${j.title}</h3>
   <p>${j.company} ‚Ä¢ ${j.location||"Remote"}</p>
  </div>`;
 });
 if(auto) content.innerHTML=html;
 return html;
}

/* Load default */
openTab("featured");
</script>

<style>
.tab-btn{
 padding:8px 16px;
 background:#e5e7eb;
 border-radius:6px;
 font-weight:bold;
}
</style>

</body>
</html>
